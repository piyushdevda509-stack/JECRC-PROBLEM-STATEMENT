{% extends 'base.html' %}

{% block content %}
<div class="change-password-container">
    <form method="post" class="change-password-form">
        <div style="text-align:center; color:rgba(7, 7, 14, 0.91); font-size:24px; font-weight:bold; margin-bottom:20px;">
            Change Password
        </div> 

        <!-- Show Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div style="margin-bottom:15px;">
              {% for category, message in messages %}
                <div style="
                    padding:10px; 
                    border-radius:5px; 
                    margin-bottom:8px; 
                    {% if category == 'success' %}
                        background:#d4edda; color:#155724; border:1px solid #c3e6cb;
                    {% elif category == 'danger' %}
                        background:#f8d7da; color:#721c24; border:1px solid #f5c6cb;
                    {% endif %}
                ">
                  {{ message }}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <div class="password-wrapper">
            <label for="old_password">Old Password</label>
            <div style="position: relative;">
                <input type="password" name="old_password" id="old_password" required>
                <span class="toggle-password" onclick="togglePassword('old_password', this)">👁️</span>
            </div>
        </div>

        <div class="password-wrapper">
            <label for="new_password">New Password</label>
            <div style="position: relative;">
                <input type="password" name="new_password" id="new_password" required>
                <span class="toggle-password" onclick="togglePassword('new_password', this)">👁️</span>
            </div>
        </div>

        <div class="password-wrapper">
            <label for="confirm_password">Confirm New Password</label>
            <div style="position: relative;">
                <input type="password" name="confirm_password" id="confirm_password" required>
                <span class="toggle-password" onclick="togglePassword('confirm_password', this)">👁️</span>
            </div>
        </div>

        <button type="submit" class="btn-3d">Change</button>
    </form>
</div>

<style>
.toggle-password {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 18px;
    user-select: none;
}
</style>

<script>
function togglePassword(fieldId, element) {
    const field = document.getElementById(fieldId);
    if (field.type === "password") {
        field.type = "text";
        element.textContent = "🙈"; // change icon
    } else {
        field.type = "password";
        element.textContent = "👁️"; // change icon back
    }
}
</script>
{% endblock %}
